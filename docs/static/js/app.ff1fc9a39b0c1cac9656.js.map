{"version":3,"sources":["webpack:///./src/appState.js","webpack:///./src/lib/simplify-path.js","webpack:///./src/lib/function-generator.js","webpack:///src/App.vue","webpack:///./src/lib/svgDownload.js","webpack:///./src/App.vue?6d61","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["qs","queryState","currentStateFromQuery","get","appState","xFormula","xf","yFormula","yf","seed","value","getSqSegDist","p","p1","p2","x","y","dx","dy","t","simplify","points","tolerance","length","sqTolerance","last","simplified","simplifyDPStep","first","maxSqDist","index","i","sqDist","push","probabilityClass","POINT","LENGTH","cfProb","TRIGONOMETRY","ARITHMETICS","MINMAX","EXP","SIGN","BaseFunctionNode","className","classCallCheck_default","this","probability","SingleArgumentFunction","operator","_this","possibleConstructorReturn_default","__proto__","get_prototype_of_default","call","prevP","getProbability","normalizeProbabilities","args","generateArguments","DualArgumentFunction","_this2","left","right","ConstantFunction","constant","_this3","fList","a","b","sum","forEach","element","Math","random","cumulativeProbability","item","Error","render","vectorField","cos","streamlinesProcess","SVGCanvas","App","name","data","paper","width","height","config","separationDistance","simplification","paperWidth","paperHeight","boundingBox","top","seedPoint","mounted","svg","size","generateStreamlines","methods","resetXFormula","resetYFormula","download","svgString","XMLSerializer","serializeToString","replace","toFixed","blob","Blob","type","svgUrl","URL","createObjectURL","downloadLink","document","createElement","href","Date","now","body","appendChild","click","removeChild","revokeObjectURL","generateDownload","compileVectorFieldFunction","code","_vectorField","Function","creator","e","alert","message","clear","svgGroup","group","streamlines_default","onStreamlineAdded","transformedPoints","tx","ty","round","simplifiedPath","polyline","fill","stroke","dSep","dTest","timeStep","run","regenerateStreamlines","func","dispose","watch","appState.xFormula","set","appState.yFormula","appState.seed.value","selectortype_template_index_0_src_App","_vm","_h","$createElement","_c","_self","staticClass","on","_v","$event","preventDefault","_m","staticRenderFns","attrs","id","src_App","__webpack_require__","normalizeComponent","ssrContext","d","__webpack_exports__","eventBus","Vue","productionTip","use","SvgIcon","tagName","el","components","template"],"mappings":"sJAEaA,QAAKC,KAEZC,EAAwBF,EAAGG,MAKpBC,GACXC,SAAUH,EAAsBI,IAJH,oCAK7BC,SAAUL,EAAsBM,IAJH,QAK7BC,MACEC,MAAOR,EAAsBO,MAAQ,KCZnCE,EAAe,SAACC,EAAGC,EAAIC,GAC3B,IAAIC,EAAIF,EAAG,GACPG,EAAIH,EAAG,GACPI,EAAKH,EAAG,GAAKC,EACbG,EAAKJ,EAAG,GAAKE,EAEjB,GAAW,IAAPC,GAAmB,IAAPC,EAAU,CACxB,IAAMC,IAAMP,EAAE,GAAKG,GAAKE,GAAML,EAAE,GAAKI,GAAKE,IAAOD,EAAKA,EAAKC,EAAKA,GAE5DC,EAAI,GACNJ,EAAID,EAAG,GACPE,EAAIF,EAAG,IACEK,EAAI,IACbJ,GAAKE,EAAKE,EACVH,GAAKE,EAAKC,GAOd,OAHAF,EAAKL,EAAE,GAAKG,GAGAE,GAFZC,EAAKN,EAAE,GAAKI,GAEUE,GAwBXE,EAAW,SAACC,EAAQC,GAC/B,GAAID,EAAOE,QAAU,EACnB,OAAOF,EAGT,IAAMG,GADNF,EAAiC,iBAAdA,EAAyBA,EAAY,GACxBA,EAE1BG,EAAOJ,EAAOE,OAAS,EAEvBG,GAAcL,EAAO,IAI3B,OAlCqB,SAAjBM,EAAkBN,EAAQO,EAAOH,EAAMD,EAAaE,GAIxD,IAHA,IAAIG,EAAYL,EACZM,SAEKC,EAAIH,EAAQ,EAAGG,EAAIN,EAAMM,IAAK,CACrC,IAAMC,EAASrB,EAAaU,EAAOU,GAAIV,EAAOO,GAAQP,EAAOI,IAEzDO,EAASH,IACXC,EAAQC,EACRF,EAAYG,GAIZH,EAAYL,IACVM,EAAQF,EAAQ,GAAGD,EAAeN,EAAQO,EAAOE,EAAON,EAAaE,GACzEA,EAAWO,KAAKZ,EAAOS,IACnBL,EAAOK,EAAQ,GAAGH,EAAeN,EAAQS,EAAOL,EAAMD,EAAaE,IAezEC,CAAeN,EAAQ,EAAGI,EAAMD,EAAaE,GAC7CA,EAAWO,KAAKZ,EAAOI,IAEhBC,4GCzDHQ,GACJC,MAHa,GAIbC,OAAQC,EACRC,aAAcD,EACdE,YAAaF,EACbG,OAAQH,EACRI,IAAKJ,EACLK,KAAML,IAGFM,aACJ,SAAAA,EAAaC,GAAWC,IAAAC,KAAAH,GACtBG,KAAKC,YAAc,EACnBD,KAAKF,UAAYA,uDAIjB,OAAOV,EAAiBY,KAAKF,4CAI7B,MAAO,YAILI,cACJ,SAAAA,EAAaC,EAAUrC,GAAGiC,IAAAC,KAAAE,GAAA,IAAAE,EAAAC,IAAAL,MAAAE,EAAAI,WAAAC,IAAAL,IAAAM,KAAAR,KAClBlC,IADkB,OAExBsC,EAAKD,SAAWA,EAFQC,wDAMxB,IAAMK,EAAQT,KAAKU,iBACnBtB,EAAiBY,KAAKF,YAAc,IACpCa,IACA,IAAIC,EAAOC,IAGX,OAFAzB,EAAiBY,KAAKF,WAAaW,EACnCE,IACOX,KAAKG,SAASS,UAbYf,GAiB/BiB,cACJ,SAAAA,EAAaX,EAAUrC,GAAGiC,IAAAC,KAAAc,GAAA,IAAAC,EAAAV,IAAAL,MAAAc,EAAAR,WAAAC,IAAAO,IAAAN,KAAAR,KAClBlC,IADkB,OAExBiD,EAAKZ,SAAWA,EAFQY,wDAMxB,IAAMN,EAAQT,KAAKU,iBACnBtB,EAAiBY,KAAKF,YAAc,IAEpCa,IACA,IAAMK,EAAOH,IACPI,EAAQJ,IAGd,OAFAzB,EAAiBY,KAAKF,WAAaW,EACnCE,IACOX,KAAKG,SAASa,EAAMC,UAfIpB,GAmB7BqB,cACJ,SAAAA,EAAaC,EAAUrD,GAAGiC,IAAAC,KAAAkB,GAAA,IAAAE,EAAAf,IAAAL,MAAAkB,EAAAZ,WAAAC,IAAAW,IAAAV,KAAAR,KAClBlC,IADkB,OAExBsD,EAAKD,SAAWA,EAFQC,wDAMxB,OAAOpB,KAAKmB,gBAPetB,GAWzBwB,GACJ,IAAIH,EAAiB,MAAO,SAC5B,IAAIA,EAAiB,MAAO,SAE5B,IAAIA,EAAiB,iCAAkC,UAEvD,IAAIhB,EAAuB,SAAAoB,GAAA,kBAAiBA,EAAjB,KAAuB,gBAClD,IAAIpB,EAAuB,SAAAoB,GAAA,kBAAiBA,EAAjB,KAAuB,gBAIlD,IAAIR,EAAqB,SAACQ,EAAGC,GAAJ,OAAaD,EAAb,IAAkBC,GAAK,eAChD,IAAIT,EAAqB,SAACQ,EAAGC,GAAJ,OAAaD,EAAb,IAAkBC,GAAK,eAChD,IAAIT,EAAqB,SAACQ,EAAGC,GAAJ,UAAcD,EAAd,IAAmBC,EAAnB,KAAyB,eAClD,IAAIT,EAAqB,SAACQ,EAAGC,GAAJ,UAAcD,EAAd,IAAmBC,EAAnB,KAAyB,eAElD,IAAIT,EAAqB,SAACQ,EAAGC,GAC3B,OAAID,IAAMC,EAAUD,EACpB,YAAmBA,EAAnB,IAAwBC,EAAxB,KACC,UACH,IAAIT,EAAqB,SAACQ,EAAGC,GAC3B,OAAID,IAAMC,EAAUD,EACpB,YAAmBA,EAAnB,IAAwBC,EAAxB,KACC,UAEH,IAAIrB,EAAuB,SAAAoB,GAAA,2BAA0BA,EAA1B,MAAiC,OAC5D,IAAIpB,EAAuB,SAAAoB,GAAA,kBAAiBA,EAAjB,KAAuB,OAClD,IAAIR,EAAqB,SAACQ,EAAGC,GAAJ,kBAAsBD,EAAtB,KAA4BC,EAA5B,KAAkC,OAE3D,IAAIrB,EAAuB,SAAAoB,GAAA,kBAAiBA,EAAjB,KAAuB,QAClD,IAAIpB,EAAuB,SAAAoB,GAAA,mBAAkBA,EAAlB,KAAwB,SAKrD,SAASX,IACP,IAAIa,EAAM,EACVH,EAAMI,QAAQ,SAAAC,GAAA,OAAYF,GAAOE,EAAQhB,mBACzCW,EAAMI,QAAQ,SAAAC,GAAA,OAAYA,EAAQzB,YAAcyB,EAAQhB,iBAAmBc,IAG7E,SAASX,IAIP,IAHA,IAAM/C,EAAI6D,KAAKC,SACXC,EAAwB,EACxBC,SACK7C,EAAI,EAAGA,EAAIoC,EAAM5C,UAGpBX,GADJ+D,IADAC,EAAOT,EAAMpC,IACiBgB,gBAFIhB,GAQpC,IAAK6C,EAAM,MAAM,IAAIC,MAAM,iBAE3B,OAAOD,EAAKE,SAGP,qCC7FPC,EAAA,SAAAnE,GACA,OACAG,EAAA0D,KAAAO,IAAAP,KAAAO,IAAApE,EAAAI,GAAAJ,EAAAG,EAAAH,EAAAI,GACAA,EAAAJ,EAAAG,IAIAkE,EAAA,KACAC,OAAA,EAEAC,GACAC,KAAA,MACAC,KAFA,WAGA,OACAjF,WACAkF,OACAC,MAAA,IACAC,OAAA,KAEAC,QACAC,mBAAA,GACAC,eAAA,GACAC,WAAA,IACAC,YAAA,IACAC,aACAhC,MAAA,EAAAiC,KAAA,EAAAR,MAAA,GAAAC,OAAA,KAEAQ,eAGAC,QApBA,WAqBAf,EAAAgB,EAAA,WAAAC,KAAArD,KAAAwC,MAAAC,MAAAzC,KAAAwC,MAAAE,QACA1C,KAAAkD,WACAjF,EAAA+B,KAAA2C,OAAAK,YAAAhC,KAAAW,KAAAC,SAAA5B,KAAA2C,OAAAK,YAAAP,MACAvE,EAAA8B,KAAA2C,OAAAK,YAAAC,IAAAtB,KAAAC,SAAA5B,KAAA2C,OAAAK,YAAAN,QAEA1C,KAAAsD,uBAEAC,SACAC,cADA,WAEAxD,KAAA1C,SAAAC,SHzE+B,qCG2E/BkG,cAJA,WAKAzD,KAAA1C,SAAAG,SH3E+B,SG6E/BiG,SAPA,YC7EgC,SAAChC,GAC/B,IAGIiC,GAAa,IAAIC,eAAiBC,kBAAkBnC,GAIxDiC,EAAYA,EAAUG,QAAQ,0CAA2C,SAAU7F,GACjF,QAASA,GAAG8F,QAAQ,KAGtB,IAAMC,EAAO,IAAIC,MAXE,yDAWiBN,IAAaO,KAAM,gCAGjDC,EAASC,IAAIC,gBAAgBL,GAE7BM,EAAeC,SAASC,cAAc,KAC5CF,EAAaG,KAAON,EACpBG,EAAaZ,SAAW,cAAgBgB,KAAKC,MAAQ,OACrDJ,SAASK,KAAKC,YAAYP,GAC1BA,EAAaQ,QACbP,SAASK,KAAKG,YAAYT,GAC1BF,IAAIY,gBAAgBb,GD8DhBc,CAAN7C,IAEA8C,2BAVA,SAUAC,GACA,IAEA,IACAC,EADA,IAAAC,SAAAF,EAAA,wBACAG,GAEA,OADAF,EAAApF,KAAAkD,WACAkC,EACA,MAAAG,GAEA,OADAC,MAAAD,EAAAE,SACA,OAGAnC,oBAtBA,WAuBAlB,EAAAsD,QACA,IAAAC,EAAAvD,EAAAwD,QACAjD,EAAA3C,KAAA2C,OACAH,EAAAxC,KAAAwC,OAEAL,EAAA0D,KAGA5D,cACA6D,kBAJA,SAIAvH,GAEA,IADA,IAAAwH,KACA9G,EAAA,EAAAA,EAAAV,EAAAE,OAAAQ,IAAA,CACA,IAAA+G,GAAAzH,EAAAU,GAAAhB,EAAA0E,EAAAK,YAAAhC,MAAA2B,EAAAK,YAAAP,MACAwD,GAAA1H,EAAAU,GAAAf,EAAAyE,EAAAK,YAAAC,KAAAN,EAAAK,YAAAN,OACAqD,EAAA5G,MAAAwC,KAAAuE,MAAAF,EAAAxD,EAAAC,MAAA,OAAAd,KAAAuE,OAAA,EAAAD,GAAAzD,EAAAE,OAAA,SAEA,IAAAyD,EAAA7H,EAAAyH,EAAApD,EAAAE,gBACA8C,EAAAS,SAAAD,GAAAE,KAAA,QAAAC,QAAA7D,MAAA,KAEA9E,KAAAqC,KAAAkD,UACAF,YAAAL,EAAAK,YAEAuD,KAAA5D,EAAAC,mBAGA4D,MAAA,KACAC,SAAA,OAEAC,OAEAC,sBArDA,WAsDA,IAAAC,GDEEjG,IAGA,iDAFWE,IAEX,aADWA,IACX,aCJFoB,EAAAjC,KAAAkF,2BAAA0B,GACAzE,EAAA0E,UACA7G,KAAAsD,wBAGAwD,OACAC,oBADA,SACAnJ,GACMV,EAAN8J,KAAAxJ,GAAAI,KAEAqJ,oBAJA,SAIArJ,GACMV,EAAN8J,KAAAtJ,GAAAE,KAEAsJ,sBAPA,SAOAtJ,GACMV,EAAN8J,KAAArJ,KAAAC,OE9IeuJ,GADEnF,OAFjB,WAA0B,IAAAoF,EAAApH,KAAaqH,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,SAAmBF,EAAA,OAAYE,YAAA,YAAsBF,EAAA,OAAYE,YAAA,qBAA+BF,EAAA,UAAeG,IAAI5C,MAAAsC,EAAAT,yBAAmCS,EAAAO,GAAA,kBAAAP,EAAAO,GAAA,KAAAJ,EAAA,OAAiDE,YAAA,WAAqBF,EAAA,OAAYE,YAAA,WAAqBL,EAAAO,GAAA,KAAAJ,EAAA,UAA2BE,YAAA,4BAAAC,IAA4C5C,MAAA,SAAA8C,GAAiD,OAAxBA,EAAAC,iBAAwBT,EAAA1D,SAAAkE,OAA8BR,EAAAO,GAAA,wCAAAP,EAAAO,GAAA,KAAAP,EAAAU,GAAA,GAAAV,EAAAO,GAAA,KAAAP,EAAAU,GAAA,MAE5eC,iBADjB,WAAoC,IAAaV,EAAbrH,KAAasH,eAA0BC,EAAvCvH,KAAuCwH,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,UAAoBF,EAAA,OAAYE,YAAA,WAAqBF,EAAA,OAAYS,OAAOC,GAAA,kBAAsB,WAAc,IAAaZ,EAAbrH,KAAasH,eAA0BC,EAAvCvH,KAAuCwH,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,mBAA6BF,EAAA,OAAYE,YAAA,WAAqBF,EAAA,MAA9IvH,KAA8I2H,GAAA,wBCE9W,IAuBeO,EAvBUC,EAAQ,OAcjCC,CACE/F,EACA8E,GATF,EAVA,SAAAkB,GACEF,EAAQ,SAaV,kBAEA,MAUgC,yCC1BhCA,EAAAG,EAAAC,EAAA,6BAAAC,IAOO,IAAMA,EAAW,IAAIC,IAE5BA,IAAI9F,OAAO+F,eAAgB,EAG3BD,IAAIE,IAAIC,KACNC,QAAS,YAIX,IAAIJ,KACFK,GAAI,OACJC,YAAc1G,OACd2G,SAAU","file":"static/js/app.ff1fc9a39b0c1cac9656.js","sourcesContent":["import queryState from 'query-state'\n\nexport const qs = queryState()\n\nconst currentStateFromQuery = qs.get()\n\nexport const defaultXFormula = 'Math.cos((Math.cos(p.y)-p.x*p.y))'\nexport const defaultYFormula = '(p.x)'\n\nexport const appState = {\n  xFormula: currentStateFromQuery.xf || defaultXFormula,\n  yFormula: currentStateFromQuery.yf || defaultYFormula,\n  seed: {\n    value: currentStateFromQuery.seed || 10\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/appState.js","// square distance from a point to a segment\nconst getSqSegDist = (p, p1, p2) => {\n  let x = p1[0]\n  let y = p1[1]\n  let dx = p2[0] - x\n  let dy = p2[1] - y\n\n  if (dx !== 0 || dy !== 0) {\n    const t = ((p[0] - x) * dx + (p[1] - y) * dy) / (dx * dx + dy * dy)\n\n    if (t > 1) {\n      x = p2[0]\n      y = p2[1]\n    } else if (t > 0) {\n      x += dx * t\n      y += dy * t\n    }\n  }\n\n  dx = p[0] - x\n  dy = p[1] - y\n\n  return dx * dx + dy * dy\n}\n\nconst simplifyDPStep = (points, first, last, sqTolerance, simplified) => {\n  let maxSqDist = sqTolerance\n  let index\n\n  for (let i = first + 1; i < last; i++) {\n    const sqDist = getSqSegDist(points[i], points[first], points[last])\n\n    if (sqDist > maxSqDist) {\n      index = i\n      maxSqDist = sqDist\n    }\n  }\n\n  if (maxSqDist > sqTolerance) {\n    if (index - first > 1) simplifyDPStep(points, first, index, sqTolerance, simplified)\n    simplified.push(points[index])\n    if (last - index > 1) simplifyDPStep(points, index, last, sqTolerance, simplified)\n  }\n}\n\n// simplification using Ramer-Douglas-Peucker algorithm\nexport const simplify = (points, tolerance) => {\n  if (points.length <= 1) {\n    return points\n  }\n  tolerance = typeof tolerance === 'number' ? tolerance : 1\n  const sqTolerance = tolerance * tolerance\n\n  const last = points.length - 1\n\n  const simplified = [points[0]]\n  simplifyDPStep(points, 0, last, sqTolerance, simplified)\n  simplified.push(points[last])\n\n  return simplified\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/simplify-path.js","const cfProb = 10 // base probability to generate a point.\n\nconst probabilityClass = {\n  POINT: cfProb,\n  LENGTH: cfProb * 0.5,\n  TRIGONOMETRY: cfProb * 0.9,\n  ARITHMETICS: cfProb * 0.6,\n  MINMAX: cfProb * 0.4,\n  EXP: cfProb * 0.1,\n  SIGN: cfProb * 0.01\n}\n\nclass BaseFunctionNode {\n  constructor (className) {\n    this.probability = 0\n    this.className = className\n  }\n\n  getProbability () {\n    return probabilityClass[this.className]\n  }\n\n  render () {\n    return ''\n  }\n}\n\nclass SingleArgumentFunction extends BaseFunctionNode {\n  constructor (operator, p) {\n    super(p)\n    this.operator = operator\n  }\n\n  render () {\n    const prevP = this.getProbability()\n    probabilityClass[this.className] *= 0.25\n    normalizeProbabilities()\n    let args = generateArguments()\n    probabilityClass[this.className] = prevP\n    normalizeProbabilities()\n    return this.operator(args)\n  }\n}\n\nclass DualArgumentFunction extends BaseFunctionNode {\n  constructor (operator, p) {\n    super(p)\n    this.operator = operator\n  }\n\n  render () {\n    const prevP = this.getProbability()\n    probabilityClass[this.className] *= 0.25\n\n    normalizeProbabilities()\n    const left = generateArguments()\n    const right = generateArguments()\n    probabilityClass[this.className] = prevP\n    normalizeProbabilities()\n    return this.operator(left, right)\n  }\n}\n\nclass ConstantFunction extends BaseFunctionNode {\n  constructor (constant, p) {\n    super(p)\n    this.constant = constant\n  }\n\n  render () {\n    return this.constant\n  }\n}\n\nconst fList = [\n  new ConstantFunction('p.x', 'POINT'),\n  new ConstantFunction('p.y', 'POINT'),\n\n  new ConstantFunction('Math.sqrt(p.x*p.x + p.y * p.y)', 'LENGTH'),\n\n  new SingleArgumentFunction(a => `Math.sin(${a})`, 'TRIGONOMETRY'),\n  new SingleArgumentFunction(a => `Math.cos(${a})`, 'TRIGONOMETRY'),\n  // new SingleArgumentFunction(a => `Math.sqrt(${a})`, cfProb * 0.8),\n  // new SingleArgumentFunction(a => `inversesqrt(${a})`, cfProb * 0.8),\n\n  new DualArgumentFunction((a, b) => `${a}*${b}`, 'ARITHMETICS'),\n  new DualArgumentFunction((a, b) => `${a}/${b}`, 'ARITHMETICS'),\n  new DualArgumentFunction((a, b) => `(${a}+${b})`, 'ARITHMETICS'),\n  new DualArgumentFunction((a, b) => `(${a}-${b})`, 'ARITHMETICS'),\n\n  new DualArgumentFunction((a, b) => {\n    if (a === b) return a\n    return `Math.min(${a},${b})`\n  }, 'MINMAX'),\n  new DualArgumentFunction((a, b) => {\n    if (a === b) return a\n    return `Math.max(${a},${b})`\n  }, 'MINMAX'),\n\n  new SingleArgumentFunction(a => `Math.log(Math.abs(${a}))`, 'EXP'),\n  new SingleArgumentFunction(a => `Math.exp(${a})`, 'EXP'),\n  new DualArgumentFunction((a, b) => `Math.pow(${a}, ${b})`, 'EXP'),\n\n  new SingleArgumentFunction(a => `Math.abs(${a})`, 'SIGN'),\n  new SingleArgumentFunction(a => `Math.sign(${a})`, 'SIGN')\n\n  // new ConstantFunction('1.', cfProb * 0.001),\n]\n\nfunction normalizeProbabilities () {\n  let sum = 0\n  fList.forEach(element => (sum += element.getProbability()))\n  fList.forEach(element => (element.probability = element.getProbability() / sum))\n}\n\nfunction generateArguments () {\n  const p = Math.random()\n  let cumulativeProbability = 0\n  let item\n  for (let i = 0; i < fList.length; ++i) {\n    item = fList[i]\n    cumulativeProbability += item.probability\n    if (p < cumulativeProbability) {\n      break\n    }\n  }\n\n  if (!item) throw new Error('no more items')\n\n  return item.render()\n}\n\nexport const generateFunction = () => {\n  normalizeProbabilities()\n  const vX = generateArguments()\n  const vY = generateArguments()\n  return `function vectorField(p) {\n  return {\n    x: ${vX},\n    y: ${vY}\n  };\n}`\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/function-generator.js","<template>\n  <div class=\"page\">\n    <!-- Sidebar -->\n    <div class=\"sidebar\">\n      <div class=\"controls-wrapper\">\n        <button @click=\"regenerateStreamlines\">Regenerate</button>\n      </div>\n\n      <div class=\"button\">\n        <div class=\"reveal\"></div>\n        <button class=\"btn btn-primary btn-block\" @click.prevent=\"download\">\n          Download SVG\n        </button>\n      </div>\n    </div>\n\n    <!-- Page Content -->\n    <div class=\"paper\">\n      <div class=\"sketch\">\n        <div id=\"drawing\"></div>\n      </div>\n    </div>\n    <div class=\"footer-wrapper\">\n        <div class=\"footer\">\n          <h1>Streamlines</h1>\n        </div>\n      </div>\n  </div>\n</template>\n\n<script>\nimport { appState, qs, defaultXFormula, defaultYFormula } from './appState'\nimport {simplify} from './lib/simplify-path'\nimport {generateFunction} from './lib/function-generator'\nimport streamlines from '@anvaka/streamlines'\nimport * as SVG from 'svg.js'\nimport {generateDownload} from './lib/svgDownload'\n\n// What function to produce streamlines for\nlet vectorField = function (p) {\n  return {\n    x: Math.cos((Math.cos(p.y) - p.x * p.y)),\n    y: (p.x)\n  }\n}\n\nlet streamlinesProcess = null\nlet SVGCanvas\n\nexport default {\n  name: 'App',\n  data () {\n    return {\n      appState,\n      paper: {\n        width: 600,\n        height: 600\n      },\n      config: {\n        separationDistance: 0.2, // Separation distance between new streamlines.\n        simplification: 0.1, // line simplification amount (0.1-2)\n        paperWidth: 600, // width and height of SVG canvas\n        paperHeight: 600,\n        boundingBox:\n          {left: -5, top: -5, width: 10, height: 10} // This is the \"zoom\" level of the rendering\n      },\n      seedPoint: {}\n    }\n  },\n  mounted () {\n    SVGCanvas = SVG('drawing').size(this.paper.width, this.paper.height)\n    this.seedPoint = {\n      x: this.config.boundingBox.left + Math.random() * this.config.boundingBox.width,\n      y: this.config.boundingBox.top + Math.random() * this.config.boundingBox.height\n    }\n    this.generateStreamlines()\n  },\n  methods: {\n    resetXFormula () {\n      this.appState.xFormula = defaultXFormula\n    },\n    resetYFormula () {\n      this.appState.yFormula = defaultYFormula\n    },\n    download () {\n      generateDownload(SVGCanvas)\n    },\n    compileVectorFieldFunction (code) {\n      try {\n        // eslint-disable-next-line no-new-func\n        let creator = new Function(code + '\\nreturn vectorField;')\n        let vectorField = creator()\n        vectorField(this.seedPoint)\n        return vectorField\n      } catch (e) {\n        alert(e.message)\n        return null\n      }\n    },\n    generateStreamlines () {\n      SVGCanvas.clear()\n      const svgGroup = SVGCanvas.group()\n      const config = this.config\n      const paper = this.paper\n\n      streamlinesProcess = streamlines({\n        // As usual, define your vector field:\n        //  vectorField(p) { return {x: Math.sin(p.x*p.x)*p.y, y: p.x}; },\n        vectorField,\n        onStreamlineAdded (points) {\n          let transformedPoints = []\n          for (let i = 0; i < points.length; i++) {\n            let tx = (points[i].x - config.boundingBox.left) / config.boundingBox.width\n            let ty = (points[i].y - config.boundingBox.top) / config.boundingBox.height\n            transformedPoints.push([Math.round(tx * paper.width * 10) / 10, Math.round(((1 - ty) * paper.height) * 10) / 10])\n          }\n          let simplifiedPath = simplify(transformedPoints, config.simplification)\n          svgGroup.polyline(simplifiedPath).fill('none').stroke({width: 1})\n        },\n        seed: this.seedPoint,\n        boundingBox: config.boundingBox,\n        // Separation distance between new streamlines.\n        dSep: config.separationDistance,\n\n        // Distance between streamlines when integration should stop.\n        dTest: 0.001,\n        timeStep: 0.05\n      })\n      streamlinesProcess.run()\n    },\n    regenerateStreamlines () {\n      let func = generateFunction()\n      vectorField = this.compileVectorFieldFunction(func)\n      streamlinesProcess.dispose()\n      this.generateStreamlines()\n    }\n  },\n  watch: {\n    'appState.xFormula' (value) {\n      qs.set({xf: value})\n    },\n    'appState.yFormula' (value) {\n      qs.set({yf: value})\n    },\n    'appState.seed.value' (value) {\n      qs.set({seed: value})\n    }\n  }\n}\n</script>\n\n<style scoped>\n  .page {\n    position: relative;\n    height: 100%;\n    display: flex;\n  }\n\n  .controls {\n    background-color: grey;\n    width: 100%;\n    margin-bottom: 50px;\n  }\n\n  .controls-wrapper {\n    max-height: 100vh;\n    overflow: scroll;\n  }\n\n  .button {\n    position: absolute;\n    bottom: 0;\n    width: 100%;\n    text-align: center;\n  }\n\n  .reveal {\n    display: block;\n    height: 15px;\n    background: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgb(47, 47, 47) 100%);\n  }\n\n  .paper {\n    background-color: #dedede;\n    position: relative;\n    max-height: 100vh;\n    width: calc(100% - 300px);\n    overflow: scroll;\n    z-index: 1;\n  }\n\n  .sidebar {\n    z-index: 10;\n    width: 300px;\n    position: relative;\n  }\n\n  .footer-wrapper {\n    z-index: 1000;\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    color: #2D2D2D;\n  }\n\n  .footer {\n    padding: 15px 15px 0 15px;\n    text-align: right;\n  }\n\n  @media (max-width: 767px) {\n    .page {\n      flex-direction: column;\n    }\n\n    .controls-wrapper {\n      max-height: none;\n    }\n\n    .sidebar {\n      width: 100%;\n    }\n\n    .paper {\n      width: 100%;\n      max-height: none;\n    }\n\n    .footer-wrapper {\n      position: relative;\n      background-color: #CCC;\n    }\n  }\n\n  .slide-enter-active,\n  .slide-leave-active {\n    transition: all 300ms ease-in-out;\n  }\n  .slide-enter-to,\n  .slide-leave {\n    max-height: 200px;\n    opacity: 1;\n    overflow: hidden;\n  }\n  .slide-enter,\n  .slide-leave-to {\n    max-height: 0;\n    opacity: 0;\n    overflow: hidden;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","export const generateDownload = (element) => {\n  const svgDoctype = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>'\n\n  // serialize our SVG XML to a string.\n  let svgString = (new XMLSerializer()).serializeToString(element)\n\n  // reduce the SVG path by cutting off floating point values after the first digit beyond floating point (~50% less MBs)\n  // eslint-disable-next-line no-useless-escape\n  svgString = svgString.replace(/([\\-+]?\\d{1,}\\.\\d{3,}([eE][\\-+]?\\d+)?)/g, function (x) {\n    return (+x).toFixed(1)\n  })\n\n  const blob = new Blob([svgDoctype + svgString], {type: 'image/svg+xml;charset=utf-8'})\n\n  /* This portion of script saves the file to local filesystem as a download */\n  const svgUrl = URL.createObjectURL(blob)\n\n  const downloadLink = document.createElement('a')\n  downloadLink.href = svgUrl\n  downloadLink.download = 'streamlines' + Date.now() + '.svg'\n  document.body.appendChild(downloadLink)\n  downloadLink.click()\n  document.body.removeChild(downloadLink)\n  URL.revokeObjectURL(svgUrl)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/svgDownload.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"sidebar\"},[_c('div',{staticClass:\"controls-wrapper\"},[_c('button',{on:{\"click\":_vm.regenerateStreamlines}},[_vm._v(\"Regenerate\")])]),_vm._v(\" \"),_c('div',{staticClass:\"button\"},[_c('div',{staticClass:\"reveal\"}),_vm._v(\" \"),_c('button',{staticClass:\"btn btn-primary btn-block\",on:{\"click\":function($event){$event.preventDefault();return _vm.download($event)}}},[_vm._v(\"\\n        Download SVG\\n      \")])])]),_vm._v(\" \"),_vm._m(0),_vm._v(\" \"),_vm._m(1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"paper\"},[_c('div',{staticClass:\"sketch\"},[_c('div',{attrs:{\"id\":\"drawing\"}})])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"footer-wrapper\"},[_c('div',{staticClass:\"footer\"},[_c('h1',[_vm._v(\"Streamlines\")])])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-a50a68f2\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-a50a68f2\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-a50a68f2\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-a50a68f2\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\nimport './sass/bootstrap.scss'\nimport SvgIcon from 'vue-svgicon'\n\nexport const eventBus = new Vue()\n\nVue.config.productionTip = false\n\n// Default tag name is 'svgicon'\nVue.use(SvgIcon, {\n  tagName: 'svgicon'\n})\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  components: { App },\n  template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}